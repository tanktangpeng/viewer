!function(global,factory){"object"==typeof exports&&"undefined"!=typeof module?factory(require("jquery")):"function"==typeof define&&define.amd?define(["jquery"],factory):factory(global.jQuery)}(this,function($){"use strict";$=$&&$.hasOwnProperty("default")?$.default:$;var DEFAULTS={inline:!1,button:!0,navbar:!0,title:!0,toolbar:!0,tooltip:!0,movable:!0,zoomable:!0,rotatable:!0,scalable:!0,transition:!0,fullscreen:!0,interval:5e3,keyboard:!0,backdrop:!0,loading:!0,loop:!0,minWidth:200,minHeight:100,zoomRatio:.1,minZoomRatio:.01,maxZoomRatio:100,zIndex:2015,zIndexInline:0,url:"src",container:"body",filter:null,ready:null,show:null,shown:null,hide:null,hidden:null,view:null,viewed:null},IN_BROWSER="undefined"!=typeof window,WINDOW=IN_BROWSER?window:{},CLASS_IN="viewer-in",CLASS_TRANSITION="viewer-transition",EVENT_POINTER_DOWN=WINDOW.PointerEvent?"pointerdown":"touchstart mousedown",EVENT_POINTER_MOVE=WINDOW.PointerEvent?"pointermove":"touchmove mousemove",EVENT_POINTER_UP=WINDOW.PointerEvent?"pointerup pointercancel":"touchend touchcancel mouseup",BUTTONS=["zoom-in","zoom-out","one-to-one","reset","prev","play","next","rotate-left","rotate-right","flip-horizontal","flip-vertical"],_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj},createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}();function isString(value){return"string"==typeof value}var isNaN=Number.isNaN||WINDOW.isNaN;function isNumber(value){return"number"==typeof value&&!isNaN(value)}function isUndefined(value){return void 0===value}function isObject(value){return"object"===(void 0===value?"undefined":_typeof(value))&&null!==value}var hasOwnProperty=Object.prototype.hasOwnProperty;function isPlainObject(value){if(!isObject(value))return!1;try{var _constructor=value.constructor,prototype=_constructor.prototype;return _constructor&&prototype&&hasOwnProperty.call(prototype,"isPrototypeOf")}catch(e){return!1}}function isFunction(value){return"function"==typeof value}function forEach(data,callback){if(data&&isFunction(callback))if(Array.isArray(data)||isNumber(data.length)){var length=data.length,i=void 0;for(i=0;i<length&&!1!==callback.call(data,data[i],i,data);i+=1);}else isObject(data)&&Object.keys(data).forEach(function(key){callback.call(data,data[key],key,data)});return data}var assign=Object.assign||function(obj){for(var _len=arguments.length,args=Array(1<_len?_len-1:0),_key=1;_key<_len;_key++)args[_key-1]=arguments[_key];return isObject(obj)&&0<args.length&&args.forEach(function(arg){isObject(arg)&&Object.keys(arg).forEach(function(key){obj[key]=arg[key]})}),obj},REGEXP_SUFFIX=/^(?:width|height|left|top|marginLeft|marginTop)$/;function setStyle(element,styles){var style=element.style;forEach(styles,function(value,property){REGEXP_SUFFIX.test(property)&&isNumber(value)&&(value+="px"),style[property]=value})}function hasClass(element,value){return element.classList?element.classList.contains(value):-1<element.className.indexOf(value)}function addClass(element,value){if(value)if(isNumber(element.length))forEach(element,function(elem){addClass(elem,value)});else if(element.classList)element.classList.add(value);else{var className=element.className.trim();className?className.indexOf(value)<0&&(element.className=className+" "+value):element.className=value}}function removeClass(element,value){value&&(isNumber(element.length)?forEach(element,function(elem){removeClass(elem,value)}):element.classList?element.classList.remove(value):0<=element.className.indexOf(value)&&(element.className=element.className.replace(value,"")))}function toggleClass(element,value,added){value&&(isNumber(element.length)?forEach(element,function(elem){toggleClass(elem,value,added)}):added?addClass(element,value):removeClass(element,value))}var REGEXP_HYPHENATE=/([a-z\d])([A-Z])/g;function hyphenate(value){return value.replace(REGEXP_HYPHENATE,"$1-$2").toLowerCase()}function getData(element,name){return isObject(element[name])?element[name]:element.dataset?element.dataset[name]:element.getAttribute("data-"+hyphenate(name))}function setData(element,name,data){isObject(data)?element[name]=data:element.dataset?element.dataset[name]=data:element.setAttribute("data-"+hyphenate(name),data)}var REGEXP_SPACES=/\s\s*/,onceSupported=function(){var supported=!1;if(IN_BROWSER){var once=!1,listener=function(){},options=Object.defineProperty({},"once",{get:function(){return supported=!0,once},set:function(value){once=value}});WINDOW.addEventListener("test",listener,options),WINDOW.removeEventListener("test",listener,options)}return supported}();function removeListener(element,type,listener){var options=3<arguments.length&&void 0!==arguments[3]?arguments[3]:{},handler=listener;type.trim().split(REGEXP_SPACES).forEach(function(event){if(!onceSupported){var listeners=element.listeners;listeners&&listeners[event]&&listeners[event][listener]&&(handler=listeners[event][listener],delete listeners[event][listener],0===Object.keys(listeners[event]).length&&delete listeners[event],0===Object.keys(listeners).length&&delete element.listeners)}element.removeEventListener(event,handler,options)})}function addListener(element,type,listener){var options=3<arguments.length&&void 0!==arguments[3]?arguments[3]:{},_handler=listener;type.trim().split(REGEXP_SPACES).forEach(function(event){if(options.once&&!onceSupported){var _element$listeners=element.listeners,listeners=void 0===_element$listeners?{}:_element$listeners;_handler=function(){for(var _len2=arguments.length,args=Array(_len2),_key2=0;_key2<_len2;_key2++)args[_key2]=arguments[_key2];delete listeners[event][listener],element.removeEventListener(event,_handler,options),listener.apply(element,args)},listeners[event]||(listeners[event]={}),listeners[event][listener]&&element.removeEventListener(event,listeners[event][listener],options),listeners[event][listener]=_handler,element.listeners=listeners}element.addEventListener(event,_handler,options)})}function dispatchEvent(element,type,data){var event=void 0;return isFunction(Event)&&isFunction(CustomEvent)?event=new CustomEvent(type,{detail:data,bubbles:!0,cancelable:!0}):(event=document.createEvent("CustomEvent")).initCustomEvent(type,!0,!0,data),element.dispatchEvent(event)}function getTransforms(_ref){var rotate=_ref.rotate,scaleX=_ref.scaleX,scaleY=_ref.scaleY,translateX=_ref.translateX,translateY=_ref.translateY,values=[];isNumber(translateX)&&0!==translateX&&values.push("translateX("+translateX+"px)"),isNumber(translateY)&&0!==translateY&&values.push("translateY("+translateY+"px)"),isNumber(rotate)&&0!==rotate&&values.push("rotate("+rotate+"deg)"),isNumber(scaleX)&&1!==scaleX&&values.push("scaleX("+scaleX+")"),isNumber(scaleY)&&1!==scaleY&&values.push("scaleY("+scaleY+")");var transform=values.length?values.join(" "):"none";return{WebkitTransform:transform,msTransform:transform,transform:transform}}var IS_SAFARI=WINDOW.navigator&&/(Macintosh|iPhone|iPod|iPad).*AppleWebKit/i.test(WINDOW.navigator.userAgent);function getImageNaturalSizes(image,callback){var newImage=document.createElement("img");if(image.naturalWidth&&!IS_SAFARI)return callback(image.naturalWidth,image.naturalHeight),newImage;var body=document.body||document.documentElement;return newImage.onload=function(){callback(newImage.width,newImage.height),IS_SAFARI||body.removeChild(newImage)},newImage.src=image.src,IS_SAFARI||(newImage.style.cssText="left:0;max-height:none!important;max-width:none!important;min-height:0!important;min-width:0!important;opacity:0;position:absolute;top:0;z-index:-1;",body.appendChild(newImage)),newImage}function getResponsiveClass(type){switch(type){case 2:return"viewer-hide-xs-down";case 3:return"viewer-hide-sm-down";case 4:return"viewer-hide-md-down";default:return""}}function getPointer(_ref2,endOnly){var pageX=_ref2.pageX,pageY=_ref2.pageY,end={endX:pageX,endY:pageY};return endOnly?end:assign({startX:pageX,startY:pageY},end)}var render={render:function(){this.initContainer(),this.initViewer(),this.initList(),this.renderViewer()},initContainer:function(){this.containerData={width:window.innerWidth,height:window.innerHeight}},initViewer:function(){var options=this.options,parent=this.parent,viewerData=void 0;options.inline&&(viewerData={width:Math.max(parent.offsetWidth,options.minWidth),height:Math.max(parent.offsetHeight,options.minHeight)},this.parentData=viewerData),!this.fulled&&viewerData||(viewerData=this.containerData),this.viewerData=assign({},viewerData)},renderViewer:function(){this.options.inline&&!this.fulled&&setStyle(this.viewer,this.viewerData)},initList:function(){var _this=this,element=this.element,options=this.options,list=this.list,items=[];forEach(this.images,function(image,i){var src=image.src,alt=image.alt||function(url){return isString(url)?url.replace(/^.*\//,"").replace(/[?&#].*$/,""):""}(src),url=options.url;isString(url)?url=image.getAttribute(url):isFunction(url)&&(url=url.call(_this,image)),(src||url)&&items.push('<li><img src="'+(src||url)+'" role="button" data-action="view" data-index="'+i+'" data-original-url="'+(url||src)+'" alt="'+alt+'"></li>')}),list.innerHTML=items.join(""),this.items=list.getElementsByTagName("li"),forEach(this.items,function(item){var image=item.firstElementChild;setData(image,"filled",!0),options.loading&&addClass(item,"viewer-loading"),addListener(image,"load",function(event){options.loading&&removeClass(item,"viewer-loading"),_this.loadImage(event)},{once:!0})}),options.transition&&addListener(element,"viewed",function(){addClass(list,CLASS_TRANSITION)},{once:!0})},renderList:function(index){var i=index||this.index,width=this.items[i].offsetWidth||30,outerWidth=width+1;setStyle(this.list,assign({width:outerWidth*this.length},getTransforms({translateX:(this.viewerData.width-width)/2-outerWidth*i})))},resetList:function(){var list=this.list;list.innerHTML="",removeClass(list,CLASS_TRANSITION),setStyle(list,getTransforms({translateX:0}))},initImage:function(done){var _this2=this,options=this.options,image=this.image,viewerData=this.viewerData,footerHeight=this.footer.offsetHeight,viewerWidth=viewerData.width,viewerHeight=Math.max(viewerData.height-footerHeight,footerHeight),oldImageData=this.imageData||{},sizingImage=void 0;this.imageInitializing={abort:function(){sizingImage.onload=null}},sizingImage=getImageNaturalSizes(image,function(naturalWidth,naturalHeight){var aspectRatio=naturalWidth/naturalHeight,width=viewerWidth,height=viewerHeight;_this2.imageInitializing=!1,viewerWidth<viewerHeight*aspectRatio?height=viewerWidth/aspectRatio:width=viewerHeight*aspectRatio;var imageData={naturalWidth:naturalWidth,naturalHeight:naturalHeight,aspectRatio:aspectRatio,ratio:(width=Math.min(.9*width,naturalWidth))/naturalWidth,width:width,height:height=Math.min(.9*height,naturalHeight),left:(viewerWidth-width)/2,top:(viewerHeight-height)/2},initialImageData=assign({},imageData);options.rotatable&&(imageData.rotate=oldImageData.rotate||0,initialImageData.rotate=0),options.scalable&&(imageData.scaleX=oldImageData.scaleX||1,imageData.scaleY=oldImageData.scaleY||1,initialImageData.scaleX=1,initialImageData.scaleY=1),_this2.imageData=imageData,_this2.initialImageData=initialImageData,done&&done()})},renderImage:function(done){var _this3=this,image=this.image,imageData=this.imageData;if(setStyle(image,assign({width:imageData.width,height:imageData.height,marginLeft:imageData.left,marginTop:imageData.top},getTransforms(imageData))),done)if(this.viewing&&this.options.transition){var onTransitionEnd=function(){_this3.imageRendering=!1,done()};this.imageRendering={abort:function(){removeListener(image,"transitionend",onTransitionEnd)}},addListener(image,"transitionend",onTransitionEnd,{once:!0})}else done()},resetImage:function(){if(this.viewing||this.viewed){var image=this.image;this.viewing&&this.viewing.abort(),image.parentNode.removeChild(image),this.image=null}}},events={bind:function(){var element=this.element,viewer=this.viewer;addListener(viewer,"click",this.onClick=this.click.bind(this)),addListener(viewer,"wheel mousewheel DOMMouseScroll",this.onWheel=this.wheel.bind(this)),addListener(viewer,"dragstart",this.onDragStart=this.dragstart.bind(this)),addListener(this.canvas,EVENT_POINTER_DOWN,this.onPointerDown=this.pointerdown.bind(this)),addListener(element.ownerDocument,EVENT_POINTER_MOVE,this.onPointerMove=this.pointermove.bind(this)),addListener(element.ownerDocument,EVENT_POINTER_UP,this.onPointerUp=this.pointerup.bind(this)),addListener(element.ownerDocument,"keydown",this.onKeyDown=this.keydown.bind(this)),addListener(window,"resize",this.onResize=this.resize.bind(this))},unbind:function(){var element=this.element,viewer=this.viewer;removeListener(viewer,"click",this.onClick),removeListener(viewer,"wheel mousewheel DOMMouseScroll",this.onWheel),removeListener(viewer,"dragstart",this.onDragStart),removeListener(this.canvas,EVENT_POINTER_DOWN,this.onPointerDown),removeListener(element.ownerDocument,EVENT_POINTER_MOVE,this.onPointerMove),removeListener(element.ownerDocument,EVENT_POINTER_UP,this.onPointerUp),removeListener(element.ownerDocument,"keydown",this.onKeyDown),removeListener(window,"resize",this.onResize)}},handlers={click:function(_ref){var target=_ref.target,options=this.options,imageData=this.imageData;switch(getData(target,"action")){case"mix":this.played?this.stop():options.inline?this.fulled?this.exit():this.full():this.hide();break;case"hide":this.hide();break;case"view":this.view(getData(target,"index"));break;case"zoom-in":this.zoom(.1,!0);break;case"zoom-out":this.zoom(-.1,!0);break;case"one-to-one":this.toggle();break;case"reset":this.reset();break;case"prev":this.prev(options.loop);break;case"play":this.play(options.fullscreen);break;case"next":this.next(options.loop);break;case"rotate-left":this.rotate(-90);break;case"rotate-right":this.rotate(90);break;case"flip-horizontal":this.scaleX(-imageData.scaleX||-1);break;case"flip-vertical":this.scaleY(-imageData.scaleY||-1);break;default:this.played&&this.stop()}},load:function(){var _this=this;this.timeout&&(clearTimeout(this.timeout),this.timeout=!1);var element=this.element,options=this.options,image=this.image,index=this.index,viewerData=this.viewerData;removeClass(image,"viewer-invisible"),options.loading&&removeClass(this.canvas,"viewer-loading"),image.style.cssText="height:0;margin-left:"+viewerData.width/2+"px;margin-top:"+viewerData.height/2+"px;max-width:none!important;position:absolute;width:0;",this.initImage(function(){toggleClass(image,"viewer-move",options.movable),toggleClass(image,CLASS_TRANSITION,options.transition),_this.renderImage(function(){_this.viewed=!0,_this.viewing=!1,isFunction(options.viewed)&&addListener(element,"viewed",options.viewed,{once:!0}),dispatchEvent(element,"viewed",{originalImage:_this.images[index],index:index,image:image})})})},loadImage:function(e){var image=e.target,parent=image.parentNode,parentWidth=parent.offsetWidth||30,parentHeight=parent.offsetHeight||50,filled=!!getData(image,"filled");getImageNaturalSizes(image,function(naturalWidth,naturalHeight){var aspectRatio=naturalWidth/naturalHeight,width=parentWidth,height=parentHeight;parentWidth<parentHeight*aspectRatio?filled?width=parentHeight*aspectRatio:height=parentWidth/aspectRatio:filled?height=parentWidth/aspectRatio:width=parentHeight*aspectRatio,setStyle(image,assign({width:width,height:height},getTransforms({translateX:(parentWidth-width)/2,translateY:(parentHeight-height)/2})))})},keydown:function(e){var options=this.options;if(this.fulled&&options.keyboard)switch(e.keyCode||e.which||e.charCode){case 27:this.played?this.stop():options.inline?this.fulled&&this.exit():this.hide();break;case 32:this.played&&this.stop();break;case 37:this.prev(options.loop);break;case 38:e.preventDefault(),this.zoom(options.zoomRatio,!0);break;case 39:this.next(options.loop);break;case 40:e.preventDefault(),this.zoom(-options.zoomRatio,!0);break;case 48:case 49:e.ctrlKey&&(e.preventDefault(),this.toggle())}},dragstart:function(e){"img"===e.target.tagName.toLowerCase()&&e.preventDefault()},pointerdown:function(e){var options=this.options,pointers=this.pointers;if(this.viewed&&!this.showing&&!this.viewing&&!this.hiding){e.changedTouches?forEach(e.changedTouches,function(touch){pointers[touch.identifier]=getPointer(touch)}):pointers[e.pointerId||0]=getPointer(e);var action=!!options.movable&&"move";1<Object.keys(pointers).length?action="zoom":"touch"!==e.pointerType&&"touchstart"!==e.type||!this.isSwitchable()||(action="switch"),this.action=action}},pointermove:function(e){var options=this.options,pointers=this.pointers,action=this.action,image=this.image;this.viewed&&action&&(e.preventDefault(),e.changedTouches?forEach(e.changedTouches,function(touch){assign(pointers[touch.identifier],getPointer(touch,!0))}):assign(pointers[e.pointerId||0],getPointer(e,!0)),"move"===action&&options.transition&&hasClass(image,CLASS_TRANSITION)&&removeClass(image,CLASS_TRANSITION),this.change(e))},pointerup:function(e){var action=this.action,pointers=this.pointers;e.changedTouches?forEach(e.changedTouches,function(touch){delete pointers[touch.identifier]}):delete pointers[e.pointerId||0],action&&("move"===action&&this.options.transition&&addClass(this.image,CLASS_TRANSITION),this.action=!1)},resize:function(){var _this2=this;if(this.isShown&&!this.hiding&&(this.initContainer(),this.initViewer(),this.renderViewer(),this.renderList(),this.viewed&&this.initImage(function(){_this2.renderImage()}),this.played)){if(this.options.fullscreen&&this.fulled&&!document.fullscreenElement&&!document.mozFullScreenElement&&!document.webkitFullscreenElement&&!document.msFullscreenElement)return void this.stop();forEach(this.player.getElementsByTagName("img"),function(image){addListener(image,"load",_this2.loadImage.bind(_this2),{once:!0}),dispatchEvent(image,"load")})}},wheel:function(e){var _this3=this;if(this.viewed&&(e.preventDefault(),!this.wheeling)){this.wheeling=!0,setTimeout(function(){_this3.wheeling=!1},50);var ratio=Number(this.options.zoomRatio)||.1,delta=1;e.deltaY?delta=0<e.deltaY?1:-1:e.wheelDelta?delta=-e.wheelDelta/120:e.detail&&(delta=0<e.detail?1:-1),this.zoom(-delta*ratio,!0,e)}}},methods={show:function(){var immediate=0<arguments.length&&void 0!==arguments[0]&&arguments[0],element=this.element,options=this.options;if(options.inline||this.showing||this.isShown||this.showing)return this;if(!this.ready)return this.build(),this.ready&&this.show(immediate),this;if(isFunction(options.show)&&addListener(element,"show",options.show,{once:!0}),!1===dispatchEvent(element,"show")||!this.ready)return this;this.hiding&&this.transitioning.abort(),this.showing=!0,this.open();var viewer=this.viewer;if(removeClass(viewer,"viewer-hide"),options.transition&&!immediate){var shown=this.shown.bind(this);this.transitioning={abort:function(){removeListener(viewer,"transitionend",shown),removeClass(viewer,CLASS_IN)}},addClass(viewer,CLASS_TRANSITION),viewer.offsetWidth,addListener(viewer,"transitionend",shown,{once:!0}),addClass(viewer,CLASS_IN)}else addClass(viewer,CLASS_IN),this.shown();return this},hide:function(){var immediate=0<arguments.length&&void 0!==arguments[0]&&arguments[0],element=this.element,options=this.options;if(options.inline||this.hiding||!this.isShown&&!this.showing)return this;if(isFunction(options.hide)&&addListener(element,"hide",options.hide,{once:!0}),!1===dispatchEvent(element,"hide"))return this;this.showing&&this.transitioning.abort(),this.hiding=!0,this.played?this.stop():this.viewing&&this.viewing.abort();var viewer=this.viewer;if(options.transition&&!immediate){var hidden=this.hidden.bind(this),hide=function(){addListener(viewer,"transitionend",hidden,{once:!0}),removeClass(viewer,CLASS_IN)};this.transitioning={abort:function(){this.viewed?removeListener(this.image,"transitionend",hide):removeListener(viewer,"transitionend",hidden)}},this.viewed?(addListener(this.image,"transitionend",hide,{once:!0}),this.zoomTo(0,!1,!1,!0)):hide()}else removeClass(viewer,CLASS_IN),this.hidden();return this},view:function(){var _this=this,index=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0;if(index=Number(index)||0,!this.isShown)return this.index=index,this.show();if(this.hiding||this.played||index<0||index>=this.length||this.viewed&&index===this.index)return this;this.viewing&&this.viewing.abort();var element=this.element,options=this.options,title=this.title,canvas=this.canvas,item=this.items[index],img=item.querySelector("img"),url=getData(img,"originalUrl"),alt=img.getAttribute("alt"),image=document.createElement("img");if(image.src=url,image.alt=alt,isFunction(options.view)&&addListener(element,"view",options.view,{once:!0}),!1===dispatchEvent(element,"view",{originalImage:this.images[index],index:index,image:image})||!this.isShown||this.hiding||this.played)return this;this.image=image,removeClass(this.items[this.index],"viewer-active"),addClass(item,"viewer-active"),this.viewed=!1,this.index=index,this.imageData={},addClass(image,"viewer-invisible"),options.loading&&addClass(canvas,"viewer-loading"),canvas.innerHTML="",canvas.appendChild(image),this.renderList(),title.innerHTML="";var onViewed=function(){var imageData=_this.imageData;title.textContent=alt+" ("+imageData.naturalWidth+" × "+imageData.naturalHeight+")"},onLoad=void 0;return addListener(element,"viewed",onViewed,{once:!0}),this.viewing={abort:function(){removeListener(element,"viewed",onViewed),image.complete?this.imageRendering?this.imageRendering.abort():this.imageInitializing&&this.imageInitializing.abort():(removeListener(image,"load",onLoad),this.timeout&&clearTimeout(this.timeout))}},image.complete?this.load():(addListener(image,"load",onLoad=this.load.bind(this),{once:!0}),this.timeout&&clearTimeout(this.timeout),this.timeout=setTimeout(function(){removeClass(image,"viewer-invisible"),_this.timeout=!1},1e3)),this},prev:function(){var loop=0<arguments.length&&void 0!==arguments[0]&&arguments[0],index=this.index-1;return index<0&&(index=loop?this.length-1:0),this.view(index),this},next:function(){var loop=0<arguments.length&&void 0!==arguments[0]&&arguments[0],maxIndex=this.length-1,index=this.index+1;return maxIndex<index&&(index=loop?0:maxIndex),this.view(index),this},move:function(offsetX,offsetY){var imageData=this.imageData;return this.moveTo(isUndefined(offsetX)?offsetX:imageData.left+Number(offsetX),isUndefined(offsetY)?offsetY:imageData.top+Number(offsetY)),this},moveTo:function(x){var y=1<arguments.length&&void 0!==arguments[1]?arguments[1]:x,imageData=this.imageData;if(x=Number(x),y=Number(y),this.viewed&&!this.played&&this.options.movable){var changed=!1;isNumber(x)&&(imageData.left=x,changed=!0),isNumber(y)&&(imageData.top=y,changed=!0),changed&&this.renderImage()}return this},zoom:function(ratio){var hasTooltip=1<arguments.length&&void 0!==arguments[1]&&arguments[1],_originalEvent=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null,imageData=this.imageData;return ratio=(ratio=Number(ratio))<0?1/(1-ratio):1+ratio,this.zoomTo(imageData.width*ratio/imageData.naturalWidth,hasTooltip,_originalEvent),this},zoomTo:function(ratio){var element,box,hasTooltip=1<arguments.length&&void 0!==arguments[1]&&arguments[1],_originalEvent=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null,_zoomable=3<arguments.length&&void 0!==arguments[3]&&arguments[3],options=this.options,pointers=this.pointers,imageData=this.imageData;if(isNumber(ratio=Math.max(0,ratio))&&this.viewed&&!this.played&&(_zoomable||options.zoomable)){if(!_zoomable){var minZoomRatio=Math.max(.01,options.minZoomRatio),maxZoomRatio=Math.min(100,options.maxZoomRatio);ratio=Math.min(Math.max(ratio,minZoomRatio),maxZoomRatio)}_originalEvent&&.95<ratio&&ratio<1.05&&(ratio=1);var newWidth=imageData.naturalWidth*ratio,newHeight=imageData.naturalHeight*ratio;if(_originalEvent){var offset=(element=this.viewer,{left:(box=element.getBoundingClientRect()).left+(window.pageXOffset-document.documentElement.clientLeft),top:box.top+(window.pageYOffset-document.documentElement.clientTop)}),center=pointers&&Object.keys(pointers).length?function(pointers){var pageX=0,pageY=0,count=0;return forEach(pointers,function(_ref3){var startX=_ref3.startX,startY=_ref3.startY;pageX+=startX,pageY+=startY,count+=1}),{pageX:pageX/=count,pageY:pageY/=count}}(pointers):{pageX:_originalEvent.pageX,pageY:_originalEvent.pageY};imageData.left-=(newWidth-imageData.width)*((center.pageX-offset.left-imageData.left)/imageData.width),imageData.top-=(newHeight-imageData.height)*((center.pageY-offset.top-imageData.top)/imageData.height)}else imageData.left-=(newWidth-imageData.width)/2,imageData.top-=(newHeight-imageData.height)/2;imageData.width=newWidth,imageData.height=newHeight,imageData.ratio=ratio,this.renderImage(),hasTooltip&&this.tooltip()}return this},rotate:function(degree){return this.rotateTo((this.imageData.rotate||0)+Number(degree)),this},rotateTo:function(degree){var imageData=this.imageData;return isNumber(degree=Number(degree))&&this.viewed&&!this.played&&this.options.rotatable&&(imageData.rotate=degree,this.renderImage()),this},scaleX:function(_scaleX){return this.scale(_scaleX,this.imageData.scaleY),this},scaleY:function(_scaleY){return this.scale(this.imageData.scaleX,_scaleY),this},scale:function(scaleX){var scaleY=1<arguments.length&&void 0!==arguments[1]?arguments[1]:scaleX,imageData=this.imageData;if(scaleX=Number(scaleX),scaleY=Number(scaleY),this.viewed&&!this.played&&this.options.scalable){var changed=!1;isNumber(scaleX)&&(imageData.scaleX=scaleX,changed=!0),isNumber(scaleY)&&(imageData.scaleY=scaleY,changed=!0),changed&&this.renderImage()}return this},play:function(){var _this2=this,fullscreen=0<arguments.length&&void 0!==arguments[0]&&arguments[0];if(!this.isShown||this.played)return this;var options=this.options,player=this.player,onLoad=this.loadImage.bind(this),list=[],total=0,index=0;if(this.played=!0,this.onLoadWhenPlay=onLoad,fullscreen&&this.requestFullscreen(),addClass(player,"viewer-show"),forEach(this.items,function(item,i){var img=item.querySelector("img"),image=document.createElement("img");image.src=getData(img,"originalUrl"),image.alt=img.getAttribute("alt"),total+=1,addClass(image,"viewer-fade"),toggleClass(image,CLASS_TRANSITION,options.transition),hasClass(item,"viewer-active")&&(addClass(image,CLASS_IN),index=i),list.push(image),addListener(image,"load",onLoad,{once:!0}),player.appendChild(image)}),isNumber(options.interval)&&0<options.interval){var play=function play(){_this2.playing=setTimeout(function(){removeClass(list[index],CLASS_IN),addClass(list[index=(index+=1)<total?index:0],CLASS_IN),play()},options.interval)};1<total&&play()}return this},stop:function(){var _this3=this;if(!this.played)return this;var player=this.player;return this.played=!1,clearTimeout(this.playing),forEach(player.getElementsByTagName("img"),function(image){removeListener(image,"load",_this3.onLoadWhenPlay)}),removeClass(player,"viewer-show"),player.innerHTML="",this.exitFullscreen(),this},full:function(){var _this4=this,options=this.options,viewer=this.viewer,image=this.image,list=this.list;return!this.isShown||this.played||this.fulled||!options.inline||(this.fulled=!0,this.open(),addClass(this.button,"viewer-fullscreen-exit"),options.transition&&(removeClass(list,CLASS_TRANSITION),this.viewed&&removeClass(image,CLASS_TRANSITION)),addClass(viewer,"viewer-fixed"),viewer.setAttribute("style",""),setStyle(viewer,{zIndex:options.zIndex}),this.initContainer(),this.viewerData=assign({},this.containerData),this.renderList(),this.viewed&&this.initImage(function(){_this4.renderImage(function(){options.transition&&setTimeout(function(){addClass(image,CLASS_TRANSITION),addClass(list,CLASS_TRANSITION)},0)})})),this},exit:function(){var _this5=this,options=this.options,viewer=this.viewer,image=this.image,list=this.list;return this.isShown&&!this.played&&this.fulled&&options.inline&&(this.fulled=!1,this.close(),removeClass(this.button,"viewer-fullscreen-exit"),options.transition&&(removeClass(list,CLASS_TRANSITION),this.viewed&&removeClass(image,CLASS_TRANSITION)),removeClass(viewer,"viewer-fixed"),setStyle(viewer,{zIndex:options.zIndexInline}),this.viewerData=assign({},this.parentData),this.renderViewer(),this.renderList(),this.viewed&&this.initImage(function(){_this5.renderImage(function(){options.transition&&setTimeout(function(){addClass(image,CLASS_TRANSITION),addClass(list,CLASS_TRANSITION)},0)})})),this},tooltip:function(){var _this6=this,options=this.options,tooltipBox=this.tooltipBox,imageData=this.imageData;return this.viewed&&!this.played&&options.tooltip&&(tooltipBox.textContent=Math.round(100*imageData.ratio)+"%",this.tooltipping?clearTimeout(this.tooltipping):options.transition?(this.fading&&dispatchEvent(tooltipBox,"transitionend"),addClass(tooltipBox,"viewer-show"),addClass(tooltipBox,"viewer-fade"),addClass(tooltipBox,CLASS_TRANSITION),tooltipBox.offsetWidth,addClass(tooltipBox,CLASS_IN)):addClass(tooltipBox,"viewer-show"),this.tooltipping=setTimeout(function(){options.transition?(addListener(tooltipBox,"transitionend",function(){removeClass(tooltipBox,"viewer-show"),removeClass(tooltipBox,"viewer-fade"),removeClass(tooltipBox,CLASS_TRANSITION),_this6.fading=!1},{once:!0}),removeClass(tooltipBox,CLASS_IN),_this6.fading=!0):removeClass(tooltipBox,"viewer-show"),_this6.tooltipping=!1},1e3)),this},toggle:function(){return 1===this.imageData.ratio?this.zoomTo(this.initialImageData.ratio,!0):this.zoomTo(1,!0),this},reset:function(){return this.viewed&&!this.played&&(this.imageData=assign({},this.initialImageData),this.renderImage()),this},update:function(){var element=this.element,options=this.options,isImg=this.isImg;if(isImg&&!element.parentNode)return this.destroy();var images=[];if(forEach(isImg?[element]:element.querySelectorAll("img"),function(image){options.filter?options.filter(image)&&images.push(image):images.push(image)}),!images.length)return this;if(this.images=images,this.length=images.length,this.ready){var indexes=[];if(forEach(this.items,function(item,i){var img=item.querySelector("img"),image=images[i];image?image.src!==img.src&&indexes.push(i):indexes.push(i)}),setStyle(this.list,{width:"auto"}),this.initList(),this.isShown)if(this.length){if(this.viewed){var index=indexes.indexOf(this.index);0<=index?(this.viewed=!1,this.view(Math.max(this.index-(index+1),0))):addClass(this.items[this.index],"viewer-active")}}else this.image=null,this.viewed=!1,this.index=0,this.imageData=null,this.canvas.innerHTML="",this.title.innerHTML=""}else this.build();return this},destroy:function(){var element=this.element,options=this.options;return getData(element,"viewer")&&(this.destroyed=!0,this.ready?(this.played&&this.stop(),options.inline?(this.fulled&&this.exit(),this.unbind()):this.isShown?(this.viewing&&(this.imageRendering?this.imageRendering.abort():this.imageInitializing&&this.imageInitializing.abort()),this.hiding&&this.transitioning.abort(),this.hidden()):this.showing&&(this.transitioning.abort(),this.hidden()),this.ready=!1,this.viewer.parentNode.removeChild(this.viewer)):options.inline&&(this.delaying?this.delaying.abort():this.initializing&&this.initializing.abort()),options.inline||removeListener(element,"click",this.onStart),function(element,name){if(isObject(element[name]))try{delete element[name]}catch(e){element[name]=void 0}else if(element.dataset)try{delete element.dataset[name]}catch(e){element.dataset[name]=void 0}else element.removeAttribute("data-"+hyphenate(name))}(element,"viewer")),this}},others={open:function(){var body=this.body;addClass(body,"viewer-open"),body.style.paddingRight=this.scrollbarWidth+(parseFloat(this.initialBodyPaddingRight)||0)+"px"},close:function(){var body=this.body;removeClass(body,"viewer-open"),body.style.paddingRight=this.initialBodyPaddingRight},shown:function(){var element=this.element,options=this.options;this.fulled=!0,this.isShown=!0,this.render(),this.bind(),this.showing=!1,isFunction(options.shown)&&addListener(element,"shown",options.shown,{once:!0}),!1!==dispatchEvent(element,"shown")&&this.ready&&this.isShown&&!this.hiding&&this.view(this.index)},hidden:function(){var element=this.element,options=this.options;this.fulled=!1,this.viewed=!1,this.isShown=!1,this.close(),this.unbind(),addClass(this.viewer,"viewer-hide"),this.resetList(),this.resetImage(),this.hiding=!1,this.destroyed||(isFunction(options.hidden)&&addListener(element,"hidden",options.hidden,{once:!0}),dispatchEvent(element,"hidden"))},requestFullscreen:function(){var document=this.element.ownerDocument;if(this.fulled&&!document.fullscreenElement&&!document.mozFullScreenElement&&!document.webkitFullscreenElement&&!document.msFullscreenElement){var documentElement=document.documentElement;documentElement.requestFullscreen?documentElement.requestFullscreen():documentElement.msRequestFullscreen?documentElement.msRequestFullscreen():documentElement.mozRequestFullScreen?documentElement.mozRequestFullScreen():documentElement.webkitRequestFullscreen&&documentElement.webkitRequestFullscreen(Element.ALLOW_KEYBOARD_INPUT)}},exitFullscreen:function(){if(this.fulled){var document=this.element.ownerDocument;document.exitFullscreen?document.exitFullscreen():document.msExitFullscreen?document.msExitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitExitFullscreen&&document.webkitExitFullscreen()}},change:function(e){var options=this.options,pointers=this.pointers,pointer=pointers[Object.keys(pointers)[0]],offsetX=pointer.endX-pointer.startX,offsetY=pointer.endY-pointer.startY;switch(this.action){case"move":this.move(offsetX,offsetY);break;case"zoom":this.zoom(function(pointers){var pointers2=assign({},pointers),ratios=[];return forEach(pointers,function(pointer,pointerId){delete pointers2[pointerId],forEach(pointers2,function(pointer2){var x1=Math.abs(pointer.startX-pointer2.startX),y1=Math.abs(pointer.startY-pointer2.startY),x2=Math.abs(pointer.endX-pointer2.endX),y2=Math.abs(pointer.endY-pointer2.endY),z1=Math.sqrt(x1*x1+y1*y1),ratio=(Math.sqrt(x2*x2+y2*y2)-z1)/z1;ratios.push(ratio)})}),ratios.sort(function(a,b){return Math.abs(a)<Math.abs(b)}),ratios[0]}(pointers),!1,e);break;case"switch":this.action="switched",this.pointers={},Math.abs(offsetX)>Math.abs(offsetY)&&(1<offsetX?this.prev(options.loop):offsetX<-1&&this.next(options.loop))}forEach(pointers,function(p){p.startX=p.endX,p.startY=p.endY})},isSwitchable:function(){var imageData=this.imageData,viewerData=this.viewerData;return 1<this.length&&0<=imageData.left&&0<=imageData.top&&imageData.width<=viewerData.width&&imageData.height<=viewerData.height}},AnotherViewer=WINDOW.Viewer,Viewer=function(){function Viewer(element){var options=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};if(function(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,Viewer),!element||1!==element.nodeType)throw new Error("The first argument is required and must be an element.");this.element=element,this.options=assign({},DEFAULTS,isPlainObject(options)&&options),this.action=!1,this.fading=!1,this.fulled=!1,this.hiding=!1,this.index=0,this.isImg=!1,this.length=0,this.played=!1,this.playing=!1,this.pointers={},this.ready=!1,this.showing=!1,this.timeout=!1,this.tooltipping=!1,this.viewed=!1,this.viewing=!1,this.isShown=!1,this.wheeling=!1,this.init()}return createClass(Viewer,[{key:"init",value:function(){var _this=this,element=this.element,options=this.options;if(!getData(element,"viewer")){setData(element,"viewer",this);var isImg="img"===element.tagName.toLowerCase(),images=[];if(forEach(isImg?[element]:element.querySelectorAll("img"),function(image){isFunction(options.filter)?options.filter.call(_this,image)&&images.push(image):images.push(image)}),images.length){this.isImg=isImg,this.length=images.length,this.images=images;var ownerDocument=element.ownerDocument,body=ownerDocument.body||ownerDocument.documentElement;if(this.body=body,this.scrollbarWidth=window.innerWidth-ownerDocument.documentElement.clientWidth,this.initialBodyPaddingRight=window.getComputedStyle(body).paddingRight,isUndefined(document.createElement("viewer").style.transition)&&(options.transition=!1),options.inline){var count=0,progress=function(){if((count+=1)===_this.length){var timeout=void 0;_this.initializing=!1,_this.delaying={abort:function(){clearTimeout(timeout)}},timeout=setTimeout(function(){_this.delaying=!1,_this.build()},0)}};this.initializing={abort:function(){forEach(images,function(image){image.complete||removeListener(image,"load",progress)})}},forEach(images,function(image){image.complete?progress():addListener(image,"load",progress,{once:!0})})}else addListener(element,"click",this.onStart=function(_ref){var target=_ref.target;"img"===target.tagName.toLowerCase()&&_this.view(_this.images.indexOf(target))})}}}},{key:"build",value:function(){if(!this.ready){var element=this.element,options=this.options,parent=element.parentNode,template=document.createElement("div");template.innerHTML='<div class="viewer-container" touch-action="none"><div class="viewer-canvas"></div><div class="viewer-footer"><div class="viewer-title"></div><div class="viewer-toolbar"></div><div class="viewer-navbar"><ul class="viewer-list"></ul></div></div><div class="viewer-tooltip"></div><div role="button" class="viewer-button" data-action="mix"></div><div class="viewer-player"></div></div>';var viewer=template.querySelector(".viewer-container"),title=viewer.querySelector(".viewer-title"),toolbar=viewer.querySelector(".viewer-toolbar"),navbar=viewer.querySelector(".viewer-navbar"),button=viewer.querySelector(".viewer-button"),canvas=viewer.querySelector(".viewer-canvas");if(this.parent=parent,this.viewer=viewer,this.title=title,this.toolbar=toolbar,this.navbar=navbar,this.button=button,this.canvas=canvas,this.footer=viewer.querySelector(".viewer-footer"),this.tooltipBox=viewer.querySelector(".viewer-tooltip"),this.player=viewer.querySelector(".viewer-player"),this.list=viewer.querySelector(".viewer-list"),addClass(title,options.title?getResponsiveClass(options.title):"viewer-hide"),addClass(navbar,options.navbar?getResponsiveClass(options.navbar):"viewer-hide"),toggleClass(button,"viewer-hide",!options.button),options.backdrop&&(addClass(viewer,"viewer-backdrop"),options.inline||!0!==options.backdrop||setData(canvas,"action","hide")),options.toolbar){var list=document.createElement("ul"),custom=isPlainObject(options.toolbar),zoomButtons=BUTTONS.slice(0,3),rotateButtons=BUTTONS.slice(7,9),scaleButtons=BUTTONS.slice(9);custom||addClass(toolbar,getResponsiveClass(options.toolbar)),forEach(custom?options.toolbar:BUTTONS,function(value,index){var deep=custom&&isPlainObject(value),name=custom?hyphenate(index):value,show=deep&&!isUndefined(value.show)?value.show:value;if(show&&(options.zoomable||-1===zoomButtons.indexOf(name))&&(options.rotatable||-1===rotateButtons.indexOf(name))&&(options.scalable||-1===scaleButtons.indexOf(name))){var size=deep&&!isUndefined(value.size)?value.size:value,click=deep&&!isUndefined(value.click)?value.click:value,item=document.createElement("li");item.setAttribute("role","button"),addClass(item,"viewer-"+name),isFunction(click)||setData(item,"action",name),isNumber(show)&&addClass(item,getResponsiveClass(show)),-1!==["small","large"].indexOf(size)?addClass(item,"viewer-"+size):"play"===name&&addClass(item,"viewer-large"),isFunction(click)&&addListener(item,"click",click),list.appendChild(item)}}),toolbar.appendChild(list)}else addClass(toolbar,"viewer-hide");if(!options.rotatable){var rotates=toolbar.querySelectorAll('li[class*="rotate"]');addClass(rotates,"viewer-invisible"),forEach(rotates,function(rotate){toolbar.appendChild(rotate)})}if(options.inline)addClass(button,"viewer-fullscreen"),setStyle(viewer,{zIndex:options.zIndexInline}),"static"===window.getComputedStyle(parent).position&&setStyle(parent,{position:"relative"}),parent.insertBefore(viewer,element.nextSibling);else{addClass(button,"viewer-close"),addClass(viewer,"viewer-fixed"),addClass(viewer,"viewer-fade"),addClass(viewer,"viewer-hide"),setStyle(viewer,{zIndex:options.zIndex});var container=options.container;isString(container)&&(container=element.ownerDocument.querySelector(container)),container||(container=this.body),container.appendChild(viewer)}options.inline&&(this.render(),this.bind(),this.isShown=!0),this.ready=!0,isFunction(options.ready)&&addListener(element,"ready",options.ready,{once:!0}),!1!==dispatchEvent(element,"ready")?this.ready&&options.inline&&this.view():this.ready=!1}}}],[{key:"noConflict",value:function(){return window.Viewer=AnotherViewer,Viewer}},{key:"setDefaults",value:function(options){assign(DEFAULTS,isPlainObject(options)&&options)}}]),Viewer}();if(assign(Viewer.prototype,render,events,handlers,methods,others),$.fn){var AnotherViewer$1=$.fn.viewer;$.fn.viewer=function(option){for(var _len=arguments.length,args=Array(1<_len?_len-1:0),_key=1;_key<_len;_key++)args[_key-1]=arguments[_key];var result=void 0;return this.each(function(i,element){var $element=$(element),isDestroy="destroy"===option,viewer=$element.data("viewer");if(!viewer){if(isDestroy)return;var options=$.extend({},$element.data(),$.isPlainObject(option)&&option);viewer=new Viewer(element,options),$element.data("viewer",viewer)}if("string"==typeof option){var fn=viewer[option];$.isFunction(fn)&&((result=fn.apply(viewer,args))===viewer&&(result=void 0),isDestroy&&$element.removeData("viewer"))}}),void 0!==result?result:this},$.fn.viewer.Constructor=Viewer,$.fn.viewer.setDefaults=Viewer.setDefaults,$.fn.viewer.noConflict=function(){return $.fn.viewer=AnotherViewer$1,this}}});